- name: Setup Web Application Infrastructure
hosts: all
become: yes
tasks:
- name: Update apt cache (Ubuntu) or yum cache (CentOS)
apt:
update_cache: yes
when: ansible_os_family == "Debian"
- name: Install required packages
apt:
name:
- nginx
- mysql-server
state: present
yum:
name:
- nginx
- mysql-server
state: present

when: ansible_os_family == "RedHat"
- name: Copy nginx configuration file
copy:
src: files/nginx.conf
dest: /etc/nginx/nginx.conf
- name: Ensure MySQL root password is set
debconf:
name: mysql-server
question: mysql-server/root_password
value: "{{ mysql_root_password }}"
vtype: password
become: yes
- name: Create database for the web application
mysql_db:
name: mywebapp
state: present
become: yes
handlers:
state: restarted
